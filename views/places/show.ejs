<% layout('layouts/app') %>
<link rel="stylesheet" href="/css/stars.css" />
<script src="https://cdn.jsdelivr.net/npm/flowbite@3.1.1/dist/flowbite.min.js"></script>
<!-- Testimonials -->
<div class="max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 lg:py-14 mx-auto">
  <!-- Grid -->
  <div class="md:grid md:grid-cols-2 md:gap-10 lg:gap-16 md:items-center">
    <div class="hidden md:block mb-24 md:mb-0 sm:px-6">
      <div class="relative">
        <!-- <img class="rounded-xl" src="<%= place.image %>" alt="Avatar" /> -->
        <div
          id="controls-carousel"
          class="relative w-full"
          data-carousel="static"
        >
          <div class="relative h-56 overflow-hidden rounded-lg md:h-96">
            <% if (place.images.length) {%> <% place.images.forEach((image,
            index) => { %>
            <div class="hidden duration-700 ease-in-out" data-carousel-item>
              <img
                src="/images/<%= image.filename %>"
                class="absolute block w-full -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2"
                alt="<%= place.title %>"
              />
            </div>
            <% });%> <% } %>
          </div>
          <% if(place.images.length > 1) { %>
          <button
            type="button"
            class="absolute top-0 start-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none"
            data-carousel-prev
          >
            <span
              class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-gray-800/30 group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-gray-800/70"
            >
              <svg
                class="w-4 h-4 text-gray-800 rtl:rotate-180"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 6 10"
              >
                <path
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M5 1 1 5l4 4"
                />
              </svg>
              <span class="sr-only">Previous</span>
            </span>
          </button>
          <button
            type="button"
            class="absolute top-0 end-0 z-30 flex items-center justify-center h-full px-4 cursor-pointer group focus:outline-none"
            data-carousel-next
          >
            <span
              class="inline-flex items-center justify-center w-10 h-10 rounded-full bg-gray-800/30 group-hover:bg-gray-800/60 group-focus:ring-4 group-focus:ring-gray-800/70"
            >
              <svg
                class="w-4 h-4 text-gray-800 rtl:rotate-180"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 6 10"
              >
                <path
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="m1 9 4-4-4-4"
                />
              </svg>
              <span class="sr-only">Next</span>
            </span>
          </button>
          <% } %>
        </div>

        <div
          class="absolute bottom-0 start-0 -z-[1] translate-y-10 -translate-x-14"
        >
          <svg
            class="max-w-40 h-auto text-gray-400"
            width="696"
            height="653"
            viewBox="0 0 696 653"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <circle cx="72.5" cy="29.5" r="29.5" fill="currentColor" />
            <circle cx="171.5" cy="29.5" r="29.5" fill="currentColor" />
            <circle cx="270.5" cy="29.5" r="29.5" fill="currentColor" />
            <circle cx="369.5" cy="29.5" r="29.5" fill="currentColor" />
            <circle cx="468.5" cy="29.5" r="29.5" fill="currentColor" />
            <circle cx="567.5" cy="29.5" r="29.5" fill="currentColor" />
            <circle cx="666.5" cy="29.5" r="29.5" fill="currentColor" />
            <circle cx="29.5" cy="128.5" r="29.5" fill="currentColor" />
            <circle cx="128.5" cy="128.5" r="29.5" fill="currentColor" />
            <circle cx="227.5" cy="128.5" r="29.5" fill="currentColor" />
            <circle cx="326.5" cy="128.5" r="29.5" fill="currentColor" />
            <circle cx="425.5" cy="128.5" r="29.5" fill="currentColor" />
            <circle cx="524.5" cy="128.5" r="29.5" fill="currentColor" />
            <circle cx="623.5" cy="128.5" r="29.5" fill="currentColor" />
            <circle cx="72.5" cy="227.5" r="29.5" fill="currentColor" />
            <circle cx="171.5" cy="227.5" r="29.5" fill="currentColor" />
            <circle cx="270.5" cy="227.5" r="29.5" fill="currentColor" />
            <circle cx="369.5" cy="227.5" r="29.5" fill="currentColor" />
            <circle cx="468.5" cy="227.5" r="29.5" fill="currentColor" />
            <circle cx="567.5" cy="227.5" r="29.5" fill="currentColor" />
            <circle cx="666.5" cy="227.5" r="29.5" fill="currentColor" />
            <circle cx="29.5" cy="326.5" r="29.5" fill="currentColor" />
            <circle cx="128.5" cy="326.5" r="29.5" fill="currentColor" />
            <circle cx="227.5" cy="326.5" r="29.5" fill="currentColor" />
            <circle cx="326.5" cy="326.5" r="29.5" fill="currentColor" />
            <circle cx="425.5" cy="326.5" r="29.5" fill="currentColor" />
            <circle cx="524.5" cy="326.5" r="29.5" fill="currentColor" />
            <circle cx="623.5" cy="326.5" r="29.5" fill="currentColor" />
            <circle cx="72.5" cy="425.5" r="29.5" fill="currentColor" />
            <circle cx="171.5" cy="425.5" r="29.5" fill="currentColor" />
            <circle cx="270.5" cy="425.5" r="29.5" fill="currentColor" />
            <circle cx="369.5" cy="425.5" r="29.5" fill="currentColor" />
            <circle cx="468.5" cy="425.5" r="29.5" fill="currentColor" />
            <circle cx="567.5" cy="425.5" r="29.5" fill="currentColor" />
            <circle cx="666.5" cy="425.5" r="29.5" fill="currentColor" />
            <circle cx="29.5" cy="524.5" r="29.5" fill="currentColor" />
            <circle cx="128.5" cy="524.5" r="29.5" fill="currentColor" />
            <circle cx="227.5" cy="524.5" r="29.5" fill="currentColor" />
            <circle cx="326.5" cy="524.5" r="29.5" fill="currentColor" />
            <circle cx="425.5" cy="524.5" r="29.5" fill="currentColor" />
            <circle cx="524.5" cy="524.5" r="29.5" fill="currentColor" />
            <circle cx="623.5" cy="524.5" r="29.5" fill="currentColor" />
            <circle cx="72.5" cy="623.5" r="29.5" fill="currentColor" />
            <circle cx="171.5" cy="623.5" r="29.5" fill="currentColor" />
            <circle cx="270.5" cy="623.5" r="29.5" fill="currentColor" />
            <circle cx="369.5" cy="623.5" r="29.5" fill="currentColor" />
            <circle cx="468.5" cy="623.5" r="29.5" fill="currentColor" />
            <circle cx="567.5" cy="623.5" r="29.5" fill="currentColor" />
            <circle cx="666.5" cy="623.5" r="29.5" fill="currentColor" />
          </svg>
        </div>
        <!-- End SVG Element -->
      </div>
    </div>
    <!-- End Col -->

    <div>
      <!-- Blockquote -->
      <blockquote class="relative">
        <svg
          class="absolute top-0 start-0 transform -translate-x-8 -translate-y-4 size-24 text-gray-200"
          width="16"
          height="16"
          viewBox="0 0 16 16"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
          aria-hidden="true"
        >
          <path
            d="M7.39762 10.3C7.39762 11.0733 7.14888 11.7 6.6514 12.18C6.15392 12.6333 5.52552 12.86 4.76621 12.86C3.84979 12.86 3.09047 12.5533 2.48825 11.94C1.91222 11.3266 1.62421 10.4467 1.62421 9.29999C1.62421 8.07332 1.96459 6.87332 2.64535 5.69999C3.35231 4.49999 4.33418 3.55332 5.59098 2.85999L6.4943 4.25999C5.81354 4.73999 5.26369 5.27332 4.84476 5.85999C4.45201 6.44666 4.19017 7.12666 4.05926 7.89999C4.29491 7.79332 4.56983 7.73999 4.88403 7.73999C5.61716 7.73999 6.21938 7.97999 6.69067 8.45999C7.16197 8.93999 7.39762 9.55333 7.39762 10.3ZM14.6242 10.3C14.6242 11.0733 14.3755 11.7 13.878 12.18C13.3805 12.6333 12.7521 12.86 11.9928 12.86C11.0764 12.86 10.3171 12.5533 9.71484 11.94C9.13881 11.3266 8.85079 10.4467 8.85079 9.29999C8.85079 8.07332 9.19117 6.87332 9.87194 5.69999C10.5789 4.49999 11.5608 3.55332 12.8176 2.85999L13.7209 4.25999C13.0401 4.73999 12.4903 5.27332 12.0713 5.85999C11.6786 6.44666 11.4168 7.12666 11.2858 7.89999C11.5215 7.79332 11.7964 7.73999 12.1106 7.73999C12.8437 7.73999 13.446 7.97999 13.9173 8.45999C14.3886 8.93999 14.6242 9.55333 14.6242 10.3Z"
            fill="currentColor"
          />
        </svg>

        <div class="relative z-10">
          <p
            class="text-2xl font-semibold text-gray-800 tracking-wide uppercase mb-1"
          >
            <%= place.title %>
          </p>
          <p
            class="text-xs font-semibold text-gray-500 tracking-wide uppercase mb-3"
          >
            <%= place.location %>
          </p>
          <p
            class="text-xs font-semibold text-gray-500 tracking-wide uppercase mb-3"
          >
            Author : <%= place.author.username %>
          </p>

          <p
            class="text-xl font-medium italic text-gray-800 md:text-2xl md:leading-normal xl:text-3xl xl:leading-normal"
          >
            <%= place.description %>
          </p>
        </div>

        <footer class="mt-6">
          <div class="flex items-center">
            <div class="md:hidden shrink-0">
              <img
                class="size-12 rounded-full"
                src="https://images.unsplash.com/photo-1492562080023-ab3db95bfbce?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=facearea&facepad=2&w=320&h=320&q=80"
                alt="Avatar"
              />
            </div>
            <div class="ms-4 md:ms-0">
              <div class="text-2xl text-gray-900">Rp. <%= place.price %></div>
            </div>
          </div>
        </footer>

        <div class="mt-8 lg:mt-14">
          <a
            class="py-3 px-4 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-transparent bg-blue-800 text-white hover:bg-gray-900 focus:outline-none focus:bg-gray-900 disabled:opacity-50 disabled:pointer-events-none"
            href="/places"
          >
            Back
          </a>
          <% if(currentUser && place.author.equals(currentUser._id)) {%>
          <a
            class="py-3 px-4 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-transparent bg-gray-800 text-white hover:bg-gray-900 focus:outline-none focus:bg-gray-900 disabled:opacity-50 disabled:pointer-events-none"
            href="/place/<%= place.id %>/edit"
          >
            Edit</a
          >
          <form
            action="/place/<%= place._id %>/delete?_method=DELETE"
            method="POST"
            class="inline-block"
          >
            <button
              class="py-3 px-4 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-transparent bg-red-800 text-white hover:bg-gray-900 focus:outline-none focus:bg-gray-900 disabled:opacity-50 disabled:pointer-events-none"
              type="submit"
            >
              Delete
            </button>
            <% } %>
          </form>
        </div>
      </blockquote>
      <!-- End Blockquote -->
    </div>
    <!-- End Col -->
  </div>
  <!-- End Grid -->
  <% if(currentUser) {%>
  <div class="mt-16">
    <h1>Add Review</h1>
    <form action="/place/<%= place._id %>/review" method="POST">
      <div class="mb-4">
        <label for="rating" class="block mb-2 text-sm font-medium text-gray-500"
          >Rating</label
        >
        <fieldset class="starability-basic">
          <input
            type="radio"
            id="no-rate"
            class="input-no-rate"
            name="review[rating]"
            value="1"
            checked
            aria-label="No rating."
          />
          <input
            type="radio"
            id="first-rate1"
            name="review[rating]"
            value="1"
          />
          <label for="first-rate1" title="Terrible">1 star</label>
          <input
            type="radio"
            id="first-rate2"
            name="review[rating]"
            value="2"
          />
          <label for="first-rate2" title="Not good">2 stars</label>
          <input
            type="radio"
            id="first-rate3"
            name="review[rating]"
            value="3"
          />
          <label for="first-rate3" title="Average">3 stars</label>
          <input
            type="radio"
            id="first-rate4"
            name="review[rating]"
            value="4"
          />
          <label for="first-rate4" title="Very good">4 stars</label>
          <input
            type="radio"
            id="first-rate5"
            name="review[rating]"
            value="5"
          />
          <label for="first-rate5" title="Amazing">5 stars</label>
        </fieldset>
      </div>
      <div class="mb-4">
        <label for="body" class="block mb-2 text-sm font-medium text-gray-700"
          >Review:</label
        >
        <textarea
          id="body"
          name="review[body]"
          rows="4"
          class="bg-gray-700 border border-gray-600 text-gray-200 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-1/2 p-2.5"
          placeholder="Enter body"
          required
        ></textarea>
      </div>
      <div class="flex justify-start">
        <button
          type="submit"
          class="px-6 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
        >
          Submit
        </button>
      </div>
    </form>
  </div>
  <% } %>

  <div class="max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 lg:py-14 mx-auto">
    <div
      class="grid grid-cols-1 gap-12 sm:grid-cols-2 md:gap-20 md:grid-cols-3 lg:grid-cols-5 lg:gap-8"
    >
      <% for(let review of place.reviews) {%>
      <div class="text-center bg-gray-200 rounded-lg p-4">
        <div class="">
          <p class="text-gray-800">" <%= review.body %> "</p>
        </div>
        <div class="shrink-0 flex justify-center gap-x-1 mt-3">
          <p class="starability-result" data-rating="<%= review.rating %>">
            Rated: <%= review.rating %> stars
          </p>
        </div>
        <% if(currentUser && review.author.equals(currentUser._id)) {%>
        <form
          action="/place/<%= place._id %>/review/<%= review._id %>?_method=DELETE"
          method="POST"
          class="inline-block mt-4"
        >
          <button
            class="py-2 px-3 inline-flex items-center gap-x-2 text-sm font-medium rounded-lg border border-transparent bg-red-800 text-white hover:bg-gray-900 focus:outline-none focus:bg-gray-900 disabled:opacity-50 disabled:pointer-events-none"
            type="submit"
          >
            Delete
          </button>
        </form>
        <% } %>
      </div>
      <% } %>
    </div>
  </div>
</div>
